{% extends 'base.html' %}
{% load static %}

{% block page_title %}Order Complete | InsiightPrep{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center text-center">
        <div class="col-lg-8 animate__animated animate__zoomIn">
            <div class="modern-card p-5">
                <div class="mx-auto bg-success-soft text-success rounded-circle d-flex align-items-center justify-content-center mb-4" style="width: 100px; height: 100px;">
                    <i class="fas fa-check-circle fs-1"></i>
                </div>
                
                <h1 class="display-6 fw-bold mb-3">Order Successful!</h1>
                <p class="text-slate-500 lead-sm mb-5">
                    Thank you for your purchase. Your payment has been verified and your papers are now ready for download.
                </p>

                <div class="p-4 rounded-5 bg-slate-50 border border-dashed mb-5">
                    <div class="row g-4 text-start">
                        <div class="col-md-6 border-end">
                            <div class="x-small text-slate-400 text-uppercase tracking-wider mb-1">Order Reference</div>
                            <div class="fw-bold text-slate-800">#{{ order.ref }}</div>
                        </div>
                        <div class="col-md-6">
                            <div class="x-small text-slate-400 text-uppercase tracking-wider mb-1">Delivery Status</div>
                            <div class="fw-bold text-success"><i class="fas fa-paper-plane me-2"></i> SMS Sent</div>
                        </div>
                    </div>
                </div>

                <div class="mb-5 text-start">
                    <h5 class="fw-bold mb-4"><i class="fas fa-download me-2 text-primary"></i> Your Downloads</h5>
                    <div class="list-group list-group-flush rounded-4 overflow-hidden border">
                        {% for item in order.items.all %}
                            <div class="list-group-item p-3 d-flex align-items-center justify-content-between bg-white">
                                <div class="d-flex align-items-center gap-3">
                                    <div class="p-2 rounded bg-slate-50">
                                        <i class="fas fa-file-pdf text-danger"></i>
                                    </div>
                                    <div>
                                        <div class="fw-bold small">{{ item.paper.title }}</div>
                                        <div class="x-small text-slate-400">PDF â€¢ {{ item.paper.file_size|default:"1.2 MB" }}</div>
                                    </div>
                                </div>
                                <a href="{{ item.paper.pdf_file.url }}" class="btn btn-primary-gradient btn-sm px-3 rounded-pill" download>
                                    Download <i class="fas fa-cloud-arrow-down ms-1"></i>
                                </a>
                            </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="alert alert-info rounded-4 border-0 shadow-sm text-start d-flex align-items-start gap-3">
                    <i class="fas fa-key fs-4 mt-1"></i>
                    <div>
                        <div class="fw-bold">Check your phone!</div>
                        <div class="small">The passwords for these secured PDF files have been sent to <strong>{{ order.phone_number }}</strong> via SMS. If you don't receive it within 5 minutes, please contact support.</div>
                    </div>
                </div>

                <div class="mt-5 d-flex flex-wrap justify-content-center gap-3">
                    <a href="{% url 'shop:class_list' %}" class="btn btn-light border px-4 py-2">
                        Back to Home
                    </a>
                    <a href="https://wa.me/233542232515" class="btn btn-success-soft text-success px-4 py-2">
                        <i class="fab fa-whatsapp me-2"></i> Report an Issue
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bg-success-soft { background: rgba(16, 185, 129, 0.1); }
    .btn-success-soft { background: rgba(16, 185, 129, 0.1); border: none; }
    .btn-success-soft:hover { background: rgba(16, 185, 129, 0.2); }
    .lead-sm { font-size: 1.1rem; }
</style>
{% endblock %}